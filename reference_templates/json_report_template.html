<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS ì›”ê°„ ë³´ì•ˆ ì ê²€ ë³´ê³ ì„œ - {account_id}</title>
    <style>
        /* ========== ì „ë¬¸ì ì¸ ê¸°ì—…ìš© ë³´ê³ ì„œ ìŠ¤íƒ€ì¼ ========== */
        
        /* ê¸°ë³¸ ë¦¬ì…‹ ë° ë³€ìˆ˜ */
        * {{ 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }}
        
        :root {{
            /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ */
            --primary-navy: #1a2332;
            --primary-dark: #2c3e50;
            --primary-blue: #3498db;
            --bg-white: #ffffff;
            --bg-light: #f8f9fa;
            --bg-lighter: #ecf0f1;
            --critical: #c0392b;
            --high: #e67e22;
            --medium: #f39c12;
            --low: #27ae60;
            --ok: #2ecc71;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-light: #95a5a6;
        }}
        
        body {{ 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', 'Apple SD Gothic Neo', Arial, sans-serif; 
            background: linear-gradient(135deg, #f5f7fa 0%, #e8eef3 100%);
            padding: 2rem;
            line-height: 1.6;
            color: var(--text-primary);
        }}
        
        /* ì»¨í…Œì´ë„ˆ */
        .container {{ 
            max-width: 1600px; 
            margin: 0 auto; 
            background: var(--bg-white); 
            border-radius: 12px; 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            overflow: hidden;
        }}
        
        /* í—¤ë” - ì „ë¬¸ì ì¸ ë„¤ì´ë¹„ ê·¸ë¼ë°ì´ì…˜ */
        .header {{ 
            background: linear-gradient(135deg, #1a2332 0%, #2c3e50 100%); 
            color: white; 
            padding: 3rem 2.5rem;
            border-bottom: 4px solid var(--primary-blue);
            position: relative;
        }}
        
        .header::after {{
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue) 0%, #5dade2 100%);
        }}
        
        .header h1 {{ 
            font-size: 2.5rem; 
            font-weight: 700; 
            margin-bottom: 1rem;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }}
        
        .header p {{ 
            font-size: 1rem; 
            opacity: 0.95;
            font-weight: 400;
            margin: 0.5rem 0;
        }}
        
        /* ì½˜í…ì¸  ì˜ì—­ */
        .content {{ 
            padding: 2.5rem; 
        }}
        
        /* ì„¹ì…˜ - ê¹”ë”í•œ í™”ì´íŠ¸ ì¹´ë“œ */
        .section {{ 
            margin-bottom: 2.5rem; 
            padding: 2rem; 
            background: var(--bg-white); 
            border-radius: 8px;
            border: 1px solid var(--bg-lighter);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }}
        
        .section h2 {{ 
            color: var(--primary-navy); 
            margin-bottom: 1.5rem; 
            font-size: 1.75rem;
            font-weight: 700;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid var(--primary-blue);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }}
        
        .section h3 {{ 
            color: var(--primary-dark); 
            margin: 1.5rem 0 1rem 0; 
            font-size: 1.25rem;
            font-weight: 600;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--bg-lighter);
        }}
        
        .section h4 {{
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
        }}
        
        /* ë©”íŠ¸ë¦­ ê·¸ë¦¬ë“œ */
        .metric-grid {{ 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); 
            gap: 1.5rem; 
            margin: 1.5rem 0;
        }}
        
        /* ë©”íŠ¸ë¦­ ì¹´ë“œ - ì „ë¬¸ì ì¸ ê·¸ë¼ë°ì´ì…˜ */
        .metric-card {{ 
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); 
            padding: 1.75rem; 
            border-radius: 8px; 
            border: 1px solid var(--bg-lighter);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }}
        
        .metric-card:hover {{ 
            transform: translateY(-4px); 
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            border-color: var(--primary-blue);
        }}
        
        .metric-card h3 {{ 
            color: var(--text-secondary); 
            font-size: 0.75rem; 
            font-weight: 600;
            text-transform: uppercase; 
            letter-spacing: 1px;
            margin-bottom: 0.75rem;
            border: none;
            padding: 0;
        }}
        
        .metric-value {{ 
            font-size: 3rem; 
            font-weight: 700; 
            color: var(--primary-navy); 
            line-height: 1.2;
            margin: 0.75rem 0;
        }}
        
        .metric-label {{ 
            color: var(--text-light); 
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }}
        
        /* í…Œì´ë¸” - ì „ë¬¸ì ì¸ ë‹¤í¬ í—¤ë” */
        table {{ 
            width: 100%; 
            border-collapse: separate;
            border-spacing: 0;
            margin: 1.5rem 0; 
            background: var(--bg-white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--bg-lighter);
        }}
        
        th, td {{ 
            padding: 1rem; 
            text-align: left; 
        }}
        
        th {{ 
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); 
            color: white; 
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--primary-blue);
        }}
        
        td {{
            border-bottom: 1px solid var(--bg-lighter);
            font-size: 0.875rem;
            color: var(--text-primary);
        }}
        
        tr:hover td {{ 
            background: #f8f9fa; 
        }}
        
        tr:last-child td {{
            border-bottom: none;
        }}
        
        /* ìƒíƒœ ìƒ‰ìƒ */
        .critical {{ 
            color: var(--critical); 
            font-weight: 700; 
        }}
        
        .high {{ 
            color: var(--high); 
            font-weight: 700; 
        }}
        
        .medium {{ 
            color: var(--medium); 
            font-weight: 600; 
        }}
        
        .low {{ 
            color: var(--low); 
            font-weight: 600; 
        }}
        
        .ok {{ 
            color: var(--ok); 
            font-weight: 600;
        }}
        
        .warning {{ 
            color: var(--medium); 
            font-weight: 600;
        }}
        
        .error {{ 
            color: var(--critical); 
            font-weight: 700;
        }}
        
        /* ë°°ì§€ - ê·¸ë¼ë°ì´ì…˜ íš¨ê³¼ */
        .badge {{ 
            display: inline-block; 
            padding: 0.375rem 0.875rem; 
            border-radius: 20px; 
            font-size: 0.75rem; 
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
        }}
        
        .badge-critical {{ 
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); 
            color: white; 
        }}
        
        .badge-warning {{ 
            background: linear-gradient(135deg, #f39c12 0%, #f1c40f 100%); 
            color: white; 
        }}
        
        .badge-ok {{ 
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); 
            color: white; 
        }}
        
        .badge-info {{ 
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%); 
            color: white; 
        }}
        
        /* ì•Œë¦¼ ë°•ìŠ¤ - ì¦‰ì‹œì¡°ì¹˜ì‚¬í•­ */
        .alert-box {{ 
            background: linear-gradient(to bottom, #fff5f5 0%, #ffffff 100%); 
            border: 2px solid var(--medium);
            border-left: 6px solid var(--medium); 
            padding: 1.5rem; 
            margin: 1.5rem 0; 
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(243, 156, 18, 0.15);
        }}
        
        .alert-box.critical {{ 
            background: linear-gradient(to bottom, #fff5f5 0%, #ffffff 100%); 
            border-color: var(--critical);
            border-left-color: var(--critical);
            box-shadow: 0 4px 16px rgba(192, 57, 43, 0.2);
        }}
        
        .alert-box h4 {{ 
            margin-bottom: 0.75rem; 
            color: #856404;
            font-weight: 700;
            font-size: 1.125rem;
        }}
        
        .alert-box.critical h4 {{ 
            color: var(--critical);
        }}
        
        /* í‘¸í„° */
        .footer {{ 
            text-align: center; 
            padding: 2rem; 
            background: linear-gradient(135deg, #ecf0f1 0%, #d5dbdb 100%); 
            color: var(--text-secondary);
            font-size: 0.875rem;
            border-top: 1px solid var(--bg-lighter);
        }}
        
        .footer p {{
            margin: 0.5rem 0;
        }}
        
        /* ë°ì´í„° ì—†ìŒ */
        .no-data {{ 
            text-align: center; 
            padding: 3rem; 
            color: var(--text-light); 
            font-style: italic;
            font-size: 1.125rem;
        }}
        
        /* ì¤€ìˆ˜ìœ¨ ì§„í–‰ë°” */
        .compliance-bar {{ 
            width: 100%; 
            height: 40px; 
            background: var(--bg-lighter); 
            border-radius: 20px; 
            overflow: hidden; 
            margin: 1rem 0;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }}
        
        .compliance-fill {{ 
            height: 100%; 
            background: linear-gradient(90deg, #27ae60 0%, #2ecc71 100%); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-weight: 700; 
            font-size: 0.875rem;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.3);
        }}
        
        .compliance-fill.warning {{ 
            background: linear-gradient(90deg, #f39c12 0%, #f1c40f 100%); 
        }}
        
        .compliance-fill.critical {{ 
            background: linear-gradient(90deg, #c0392b 0%, #e74c3c 100%); 
        }}
    </style>
</head>
<body>
    <div class="container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1>ğŸ”’ AWS ì›”ê°„ ë³´ì•ˆ ì ê²€ ë³´ê³ ì„œ</h1>
            <p><strong>ê³„ì •:</strong> {account_id} | <strong>ë¦¬ì „:</strong> {region}</p>
            <p><strong>ë³´ê³ ì„œ ìƒì„±ì¼:</strong> {report_date}</p>
            <p><strong>ì ê²€ ê¸°ê°„:</strong> {period_start} ~ {period_end}</p>
        </div>

        <div class="content">
            <!-- ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš” í•­ëª© -->
            {critical_issues_section}

            <!-- ì „ì²´ ìš”ì•½ -->
            <div class="section">
                <h2>ğŸ“Š ì „ì²´ ìš”ì•½</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <h3>EC2 ì¸ìŠ¤í„´ìŠ¤</h3>
                        <div class="metric-value">{ec2_total}</div>
                        <div class="metric-label">ì‹¤í–‰ ì¤‘: {ec2_running} | ì¤‘ì§€: {ec2_stopped}</div>
                    </div>
                    <div class="metric-card">
                        <h3>S3 ë²„í‚·</h3>
                        <div class="metric-value">{s3_total}</div>
                        <div class="metric-label">ì•”í˜¸í™”: {s3_encrypted} ({s3_encrypted_rate}%)</div>
                    </div>
                    <div class="metric-card">
                        <h3>RDS ì¸ìŠ¤í„´ìŠ¤</h3>
                        <div class="metric-value">{rds_total}</div>
                        <div class="metric-label">Multi-AZ: {rds_multi_az}</div>
                    </div>
                    <div class="metric-card">
                        <h3>IAM ì‚¬ìš©ì</h3>
                        <div class="metric-value">{iam_users_total}</div>
                        <div class="metric-label">MFA: {iam_mfa_enabled} ({iam_mfa_rate}%)</div>
                    </div>
                    <div class="metric-card">
                        <h3>ë³´ì•ˆ ê·¸ë£¹</h3>
                        <div class="metric-value">{sg_total}</div>
                        <div class="metric-label error">ìœ„í—˜ ê·œì¹™: {sg_risky}</div>
                    </div>
                    <div class="metric-card">
                        <h3>Critical ì´ìŠˆ</h3>
                        <div class="metric-value critical">{critical_issues_count}</div>
                        <div class="metric-label">ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš”</div>
                    </div>
                </div>
            </div>

            <!-- ì•”í˜¸í™” ì¤€ìˆ˜ìœ¨ -->
            <div class="section">
                <h2>ğŸ”’ ì•”í˜¸í™” ì¤€ìˆ˜ìœ¨</h2>
                <div style="margin: 20px 0;">
                    <h4>EBS ë³¼ë¥¨ ì•”í˜¸í™”: {ebs_encrypted}/{ebs_total} ({ebs_rate}%)</h4>
                    <div class="compliance-bar">
                        <div class="compliance-fill {ebs_compliance_class}" style="width: {ebs_rate}%;">{ebs_rate}%</div>
                    </div>
                </div>
                <div style="margin: 20px 0;">
                    <h4>S3 ë²„í‚· ì•”í˜¸í™”: {s3_encrypted}/{s3_total} ({s3_encrypted_rate}%)</h4>
                    <div class="compliance-bar">
                        <div class="compliance-fill {s3_compliance_class}" style="width: {s3_encrypted_rate}%;">{s3_encrypted_rate}%</div>
                    </div>
                </div>
                <div style="margin: 20px 0;">
                    <h4>RDS ì•”í˜¸í™”: {rds_encrypted}/{rds_total} ({rds_encrypted_rate}%)</h4>
                    <div class="compliance-bar">
                        <div class="compliance-fill {rds_compliance_class}" style="width: {rds_encrypted_rate}%;">{rds_encrypted_rate}%</div>
                    </div>
                </div>
            </div>

            <!-- EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„¸ -->
            <div class="section">
                <h2>ï¿½ï¸ë¦¬ EC2 ì¸ìŠ¤í„´ìŠ¤ ({ec2_total}ê°œ)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ì´ë¦„</th>
                            <th>ì¸ìŠ¤í„´ìŠ¤ ID</th>
                            <th>íƒ€ì…</th>
                            <th>ìƒíƒœ</th>
                            <th>í¼ë¸”ë¦­ IP</th>
                            <th>IMDSv2</th>
                            <th>ìƒì„¸ ëª¨ë‹ˆí„°ë§</th>
                            <th>EBS ì‚­ì œë°©ì§€</th>
                        </tr>
                    </thead>
                    <tbody>
                        {ec2_rows}
                    </tbody>
                </table>
            </div>

            <!-- S3 ë²„í‚· ìƒì„¸ -->
            <div class="section">
                <h2>ğŸ’¾ S3 ë²„í‚· ({s3_total}ê°œ)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ë²„í‚· ì´ë¦„</th>
                            <th>ë¦¬ì „</th>
                            <th>ì•”í˜¸í™”</th>
                            <th>ë²„ì €ë‹</th>
                            <th>í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤ ì°¨ë‹¨</th>
                            <th>ìƒì„±ì¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        {s3_rows}
                    </tbody>
                </table>
            </div>

            <!-- RDS ì¸ìŠ¤í„´ìŠ¤ ìƒì„¸ -->
            <div class="section">
                <h2>ğŸ—„ï¸ RDS ì¸ìŠ¤í„´ìŠ¤ ({rds_total}ê°œ)</h2>
                {rds_content}
            </div>

            <!-- Lambda í•¨ìˆ˜ -->
            <div class="section">
                <h2>âš¡ Lambda í•¨ìˆ˜ ({lambda_total}ê°œ)</h2>
                {lambda_content}
            </div>

            <!-- EBS ë³¼ë¥¨ (ì•”í˜¸í™” ë¯¸ì„¤ì •) -->
            {ebs_unencrypted_section}

            <!-- S3 ë²„í‚· (ë³´ì•ˆ ì´ìŠˆ) -->
            {s3_security_issues_section}

            <!-- IAM ë³´ì•ˆ -->
            <div class="section">
                <h2>ğŸ” IAM ì‚¬ìš©ì ë³´ì•ˆ ({iam_users_total}ëª…)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ì‚¬ìš©ìëª…</th>
                            <th>MFA</th>
                            <th>ì•¡ì„¸ìŠ¤ í‚¤</th>
                            <th>ì•¡ì„¸ìŠ¤ í‚¤ ìƒì„±ì¼</th>
                            <th>ë³´ì•ˆ ìƒíƒœ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {iam_users_rows}
                    </tbody>
                </table>
            </div>

            <!-- ë³´ì•ˆ ê·¸ë£¹ ìœ„í—˜ ê·œì¹™ -->
            <div class="section">
                <h2>ğŸ›¡ï¸ ë³´ì•ˆ ê·¸ë£¹ ìœ„í—˜ ê·œì¹™ ({sg_risky}ê°œ)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ë³´ì•ˆ ê·¸ë£¹ ID</th>
                            <th>ì´ë¦„</th>
                            <th>VPC</th>
                            <th>í¬íŠ¸</th>
                            <th>í”„ë¡œí† ì½œ</th>
                            <th>ì†ŒìŠ¤</th>
                            <th>ìœ„í—˜ë„</th>
                        </tr>
                    </thead>
                    <tbody>
                        {sg_risky_rows}
                    </tbody>
                </table>
            </div>

            <!-- Trusted Advisor ìš”ì•½ -->
            <div class="section">
                <h2>âœ… Trusted Advisor ì ê²€ ê²°ê³¼</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <h3>ë³´ì•ˆ</h3>
                        <div class="metric-value error">{ta_security_error}</div>
                        <div class="metric-label">Error: {ta_security_error} | Warning: {ta_security_warning}</div>
                    </div>
                    <div class="metric-card">
                        <h3>ë‚´ê²°í•¨ì„±</h3>
                        <div class="metric-value warning">{ta_fault_tolerance_error}</div>
                        <div class="metric-label">Error: {ta_fault_tolerance_error} | Warning: {ta_fault_tolerance_warning}</div>
                    </div>
                    <div class="metric-card">
                        <h3>ë¹„ìš© ìµœì í™”</h3>
                        <div class="metric-value">{ta_cost_warning}</div>
                        <div class="metric-label">Warning: {ta_cost_warning}</div>
                    </div>
                    <div class="metric-card">
                        <h3>ì„±ëŠ¥</h3>
                        <div class="metric-value">{ta_performance_warning}</div>
                        <div class="metric-label">Warning: {ta_performance_warning}</div>
                    </div>
                </div>
                
                <h3>ì£¼ìš” ë°œê²¬ì‚¬í•­ (Error í•­ëª©)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ì¹´í…Œê³ ë¦¬</th>
                            <th>ì ê²€ í•­ëª©</th>
                            <th>ìƒíƒœ</th>
                            <th>ì˜í–¥ë°›ëŠ” ë¦¬ì†ŒìŠ¤</th>
                        </tr>
                    </thead>
                    <tbody>
                        {ta_error_rows}
                    </tbody>
                </table>
            </div>

            <!-- CloudTrail ì¤‘ìš” ì´ë²¤íŠ¸ -->
            <div class="section">
                <h2>ğŸ“‹ CloudTrail ì¤‘ìš” ì´ë²¤íŠ¸ (ìµœê·¼ {cloudtrail_days}ì¼)</h2>
                <table>
                    <thead>
                        <tr>
                            <th>ì´ë²¤íŠ¸ íƒ€ì…</th>
                            <th>ì‹¬ê°ë„</th>
                            <th>ì¹´í…Œê³ ë¦¬</th>
                            <th>ë°œìƒ íšŸìˆ˜</th>
                            <th>ì„¤ëª…</th>
                        </tr>
                    </thead>
                    <tbody>
                        {cloudtrail_critical_rows}
                    </tbody>
                </table>
            </div>

            <!-- CloudWatch ì•ŒëŒ -->
            <div class="section">
                <h2>ğŸ“ˆ CloudWatch ì•ŒëŒ ({cloudwatch_alarms_total}ê°œ)</h2>
                <div class="metric-grid">
                    <div class="metric-card">
                        <h3>ë°œìƒ ì¤‘ (ALARM)</h3>
                        <div class="metric-value error">{cloudwatch_alarms_in_alarm}</div>
                    </div>
                    <div class="metric-card">
                        <h3>ì •ìƒ (OK)</h3>
                        <div class="metric-value ok">{cloudwatch_alarms_ok}</div>
                    </div>
                    <div class="metric-card">
                        <h3>ë°ì´í„° ë¶€ì¡±</h3>
                        <div class="metric-value">{cloudwatch_alarms_insufficient}</div>
                    </div>
                </div>
                
                <h3>ì•ŒëŒ ìƒì„¸</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ì•ŒëŒ ì´ë¦„</th>
                            <th>ìƒíƒœ</th>
                            <th>ë©”íŠ¸ë¦­</th>
                            <th>ì„ê³„ê°’</th>
                        </tr>
                    </thead>
                    <tbody>
                        {cloudwatch_alarm_rows}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- í‘¸í„° -->
        <div class="footer">
            <p>ğŸ¤– ì´ ë³´ê³ ì„œëŠ” AWS Boto3 APIë¥¼ í†µí•´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤</p>
            <p><strong>ìƒì„± ì‹œê°„:</strong> {report_date} | <strong>ê³„ì •:</strong> {account_id} | <strong>ë¦¬ì „:</strong> {region}</p>
            <p>ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ë³´ì•ˆíŒ€ì— ì—°ë½í•´ì£¼ì„¸ìš”</p>
        </div>
    </div>
</body>
</html>

